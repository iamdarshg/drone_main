<deployment>
  <instance
    name="gpio"
    type="Hal::Gpio"
  />
  <instance
    name="i2c"
    type="Hal::I2c"
  />
  <instance
    name="spi"
    type="Hal::Spi"
  />
  <instance
    name="uart"
    type="Hal::Uart"
  />
  <instance
    name="can"
    type="Hal::Can"
  />
  <instance
    name="imu"
    type="Sensors::Lsm6ds3"
  />
  <instance
    name="baro"
    type="Sensors::Icp101xx"
  />
  <instance
    name="gps"
    type="Sensors::Neo6m"
  />
  <instance
    name="kx122"
    type="Sensors::Kx122"
  />
  <instance
    name="sensor_fusion"
    type="FSW::SensorFusion"
  />
  <instance
    name="pid"
    type="Control::Pid"
  />
  <instance
    name="mixer"
    type="Control::Mixer"
  />
  <instance
    name="motor1"
    type="Actuators::Motor"
  />
  <instance
    name="motor2"
    type="Actuators::Motor"
  />
  <instance
    name="motor3"
    type="Actuators::Motor"
  />
  <instance
    name="motor4"
    type="Actuators::Motor"
  />
  <instance
    name="pyro"
    type="Actuators::Pyro"
  />
  <instance
    name="navigation"
    type="Navigation::Navigation"
  />
  <connections>
    <!-- HAL Connections -->
    <connection name="i2c_imu" source="i2c.i2cWrite" target="imu.i2cWrite" />
    <connection name="i2c_baro" source="i2c.i2cWrite" target="baro.i2cWrite" />
    <connection name="i2c_kx122" source="i2c.i2cWrite" target="kx122.i2cWrite" />
    <connection name="uart_gps" source="uart.uartWrite" target="gps.uartWrite" />

    <!-- Sensor Connections -->
    <connection name="imu_fusion" source="imu.imuOut" target="sensor_fusion.imuIn" />
    <connection name="baro_fusion" source="baro.pressureOut" target="sensor_fusion.pressureIn" />
    <connection name="kx122_fusion" source="kx122.accelOut" target="sensor_fusion.imuIn2" />
    <connection name="gps_fusion" source="gps.gpsOut" target="sensor_fusion.gpsIn" />

    <!-- Navigation and Control Connections -->
    <connection name="fusion_pid" source="sensor_fusion.attitudeOut" target="pid.attitudeIn" />
    <connection name="nav_pid" source="navigation.guidanceOut" target="pid.setpointIn" />
    <connection name="pid_mixer" source="pid.actuatorOut" target="mixer.actuatorIn" />

    <!-- Mixer to Motor Connections -->
    <connection name="mixer_motor1" source="mixer.motor1Out" target="motor1.speedIn" />
    <connection name="mixer_motor2" source="mixer.motor2Out" target="motor2.speedIn" />
    <connection name="mixer_motor3" source="mixer.motor3Out" target="motor3.speedIn" />
    <connection name="mixer_motor4" source="mixer.motor4Out" target="motor4.speedIn" />

    <!-- GPS to Navigation -->
    <connection name="gps_nav" source="gps.gpsOut" target="navigation.gpsIn" />
  </connections>
</deployment>
